# Workflow: Extern Complex
# Komplexes externes Projekt (nicht HELIX-intern)
#
# Ablauf: Feasibility -> Planning-Agent -> [1-5 dynamische Phasen] -> Verify -> Documentation

name: extern-complex
description: Komplexes externes Projekt mit dynamischer Phasen-Generierung
project_type: external
complexity: complex
max_retries: 3  # Pro Phase mit Sub-Agent Verifikation
max_dynamic_phases: 5  # Maximum für dynamisch generierte Phasen

phases:
  - id: feasibility
    name: "Feasibility Check"
    type: consultant
    description: "Prüfe Machbarkeit und Projektumfang"
    template: consultant/feasibility.md
    output:
      - "feasibility-report.md"
    quality_gate:
      type: review_approved
    verify_agent: true
    optional: true  # Kann übersprungen werden bei klarer Anforderung

  - id: planning-agent
    name: "Planning Agent"
    type: planning
    description: "Analysiere Anforderungen und zerlege in Teilaufgaben"
    template: consultant/planning-agent.md
    output:
      - "spec.yaml"
      - "phases.yaml"
      - "decomposed-phases.yaml"
    quality_gate:
      type: files_exist
    verify_agent: true
    generates_phases: true  # Markiert dass dieser Schritt Phasen generiert
    phase_config:
      min_phases: 1
      max_phases: 5
      phase_template: developer/generic.md

  # Dynamische Phasen werden hier eingefügt
  # Format: dev-{n} mit n = 1..max_dynamic_phases

  - id: verify
    name: "Verification"
    type: test
    description: "Umfassende Tests aller implementierten Komponenten"
    template: testing/comprehensive.md
    output:
      - "tests/**/*"
    quality_gate:
      type: tests_pass
    verify_agent: true
    after_dynamic: true  # Kommt nach den dynamischen Phasen
    optional: true  # Tests optional bei externen Projekten

  - id: documentation
    name: "Documentation"
    type: documentation
    description: "Vollständige Projekt-Dokumentation"
    template: documentation/comprehensive.md
    output:
      - "README.md"
      - "docs/**/*.md"
      - "API.md"
    quality_gate:
      type: files_exist
    verify_agent: true
    after_dynamic: true

# Dynamische Phase Template für externe Projekte
dynamic_phase_template:
  id: "dev-{n}"
  name: "Development Phase {n}: {description}"
  type: development
  template: developer/generic.md
  output:
    - "src/**/*"
  quality_gate:
    type: syntax_check
  verify_agent: true

# Kein Deploy-Zyklus bei externen Projekten
# Externe Projekte werden nicht in HELIX integriert
